<html>
    <head>
        <title>Main Page</title>
        <style>
            body {
                background-color: #b29d6f;
                font-family: "SilkScreen";
            }

            @font-face {
                font-family: "SilkScreen";
                src: url("/fonts/silkscreen/slkscr.ttf") format("truetype");
            }

            .frameBorder {
                border: solid 1px black;
                text-align: center;
            }
            .topAndBottomBorder {
                border-top: solid 1px black;
                border-bottom: solid 1px black;
            }
            .envPanel {
                cursor: pointer;
            }
            .clickable {
                cursor: pointer;
            }
            .direction {
                border: 1px solid white;
            }
            #title {
                text-align: center;
                font-size: 140pt;
                font-family: "SilkScreen";
            }
        </style>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="https://cdn.socket.io/socket.io-1.0.0.js"></script>
        <script src="/js/util.js"></script>
        <script src="/js/interaction.js"></script>
        <script>
            /** Globals **/
            var socket = io('http://localhost:3000/');
            var Character;

            $(document).ready(function() {
                socket.on('connect', function () {
                    console.log("Connected to Game sever.");
                });

                socket.on("Character.Loaded", function(character) {
                    console.log("Loaded Character");
                    Character = character;
                    loadCharacter(character);

                    setInterval(function() {
                        updateLocation();
                    }, 5000);

                    $("#title").hide();
                    $(".gameUI").removeClass("hide");
                    $("#loadCharacterModal").modal("hide");
                    $("#newCharacterModal").modal("hide");
                });

                socket.on("Character.Environment.Update", function(environment) {
                    console.log("Loading Environment");
                    loadEnvironment(environment);
                });

                $("#newGame").on("click", function(e) {
                    $("#newCharacterModal").modal("show");
                    $("#loadCharacterModal").modal("hide");
                    //socket.send("event", {name: "Character.Create", content: {Name: "Test", Sex: "M", Race: "Orc", Class: "Warrior"}});
                });

                $("#loadGame").on("click", function(e) {
                    $("#loadCharacterModal").modal("show");
                    $("#newCharacterModal").modal("hide");
                    //socket.send("event", {name: "Character.Create", content: {Name: "Test", Sex: "M", Race: "Orc", Class: "Warrior"}});
                });

                $("#loadCharacterForm").on("submit", function(e) {
                    e.preventDefault();

                    var values = {};
                    $.each($('#loadCharacterForm').serializeArray(), function(i, field) {
                        values[field.name] = field.value;
                    });

                    socket.emit("Character.Load", values);
                });

                $("#newCharacterForm").on("submit", function(e) {
                    e.preventDefault();

                    var values = {};
                    $.each($('#newCharacterForm').serializeArray(), function(i, field) {
                        values[field.name] = field.value;
                    });

                    socket.emit("Character.Create", values);
                });

                $(".control").on("click", function(e) {
                    alert(this.id);
                });
            });

            populateClassesList();
            populateRacesList();
        </script>
    </head>
    <body>
        <div class="nav">
            <ul id="mainMenu" class="nav nav-pills">
                <li role="presentation"><a id="newGame" class="btn btn-default">New Character</a></li>
                <li role="presentation"><a id="loadGame" class="btn btn-default">Load Character</a></li>
            </ul>
        </div>
        <br>
        <div id="title" class="jumbotron">
            OpenQuest
        </div>
        <div class="col-lg-5 topAndBottomBorder hide gameUI">
            <ul class="nav nav-tabs">
                <li class="active"><a class="btn btn-default" data-toggle="tab" href="#statTab">Status</a></li>
                <li><a class="btn btn-default" data-toggle="tab" href="#magicTab">Magic</a></li>
                <li><a class="btn btn-default" data-toggle="tab" href="#inventoryTab">Inventory</a></li>
            </ul>
            <div class="tab-content">
                <div id="statTab" class="tab-pane fade in active">
                    <table id="statsTable" class="table table-striped">
                    <tr>
                        <td>Name</td><td id="characterName"></td>
                        <td>Sex</td><td id="characterSex"></td>
                    </tr>
                    <tr>
                        <td>Race</td><td id="characterRace"></td>
                        <td>Class</td><td id="characterClass"></td>
                    </tr>
                    <tr>
                        <td>Latitude</td><td id="characterLat"></td>
                        <td>Longitude</td><td id="characterLon"></td>
                    </tr>
                    <tr>
                        <td>Level</td><td id="characterLevel"></td>
                        <td>Experience</td><td id="characterExperience"></td>
                    </tr>
                    <tr>
                        <td>Strength</td><td id="characterStrength"></td>
                        <td>Dexterity</td><td id="characterDexterity"></td>
                    </tr><tr>
                        <td>Constitution</td><td id="characterConstitution"></td>
                        <td>Intelligence</td><td id="characterIntelligence"></td>
                    </tr><tr>
                        <td>Magic</td><td id="characterMagic"></td>
                        <td>Spirit</td><td id="characterSpirit"></td>
                    </tr>
                    </table>
                </div>
                <div id="magicTab" class="tab-pane fade">
                    <table id="magicTable" class="table table-striped">
                        <tr>
                            <td>Fire</td><td id="characterFire"></td>
                            <td>Ice</td><td id="characterIce"></td>
                        </tr>
                        <tr>
                            <td>Thunder</td><td id="characterThunder"></td>
                            <td>Earth</td><td id="characterEarth"></td>
                        </tr>
                        <tr>
                            <td>Water</td><td id="characterWater"></td>
                            <td>Wood</td><td id="characterWood"></td>
                        </tr>
                        <tr>
                            <td>Toxin</td><td id="characterToxin"></td>
                            <td>Holy</td><td id="characterHoly"></td>
                        </tr>
                    </table>
                </div>
                <div id="inventoryTab" class="tab-pane fade">
                    <table id="inventoryTable"></table>
                </div>
            </div>
            <div id="actionsConsole">
                <button id="attack" class="btn btn-standard" disabled="true">Attack</button>
                <button id="interact" class="btn btn-standard" disabled="true">Interact</button>
                <button id="pickUp" class="btn btn-standard" disabled="true">Pick Up</button>
                <br>
                <textarea id="console" class="form-control" rows="5" style="width:100%">

                </textarea>
            </div>
            <br>
        </div>
        <div class="col-lg-6 frameBorder hide gameUI">
            <svg id="dir_nw" class="envPanel" width="200" height="200"></svg>
            <svg id="dir_n" class="envPanel" width="200" height="200"></svg>
            <svg id="dir_ne" class="envPanel" width="200" height="200"></svg>
            <svg id="dir_w" class="envPanel" width="200" height="200"></svg>
            <svg id="center" class="envPanel" width="200" height="200"></svg>
            <svg id="dir_e" class="envPanel" width="200" height="200"></svg>
            <svg id="dir_sw" class="envPanel" width="200" height="200"></svg>
            <svg id="dir_s" class="envPanel" width="200" height="200"></svg>
            <svg id="dir_se" class="envPanel" width="200" height="200"></svg>
        </div>
        <!--<div class="col-lg-2 frameBorder">-->
            <!--<svg height="400" width="400">-->
                <!--<polygon id="up" points="120,100 90,150 150,150" fill="black" class="control clickable"></polygon>-->
                <!--<polygon id="left" points="40,200 80,240 80,160" fill="black" class="control clickable"></polygon>-->
                <!--<polygon id="right" points="200,200 160,240 160,160" fill="black" class="control clickable"></polygon>-->
                <!--<polygon id="down" points="120,300 90,250 150,250" fill="black" class="control clickable"></polygon>-->
            <!--</svg>-->
        <!--</div>-->
        <div id="newCharacterModal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">New Game</h4>
                    </div>
                    <div class="modal-body">
                        <p>New Character</p>
                        <form id="newCharacterForm" action="/character" method="POST">
                            <div class="form-group">
                                <label for="name">Name</label>
                                <input id="name" class="form-control" type="text" name="name">
                            </div>
                            <div class="form-group">
                                <label for="sex">Sex</label>
                                <select id="sex" class="form-control" name="sex">
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="class">Class</label>
                                <select id="class" class="form-control" name="class"></select>
                            </div>
                            <div class="form-group">
                                <label for="race">Race</label>
                                <select id="race" class="form-control" name="race"></select>
                            </div>
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input id="password" class="form-control" type="password" name="password">
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn btn-default">Submit</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </form>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div>
        <div id="loadCharacterModal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Load Game</h4>
                    </div>
                    <div class="modal-body">
                        <form id="loadCharacterForm">
                            <div class="form-group">
                                <label for="loadName">Name</label>
                                <input id="loadName" class="form-control" type="text" name="name">
                            </div>
                            <div class="form-group">
                                <label for="loadPassword">Password</label>
                                <input id="loadPassword" class="form-control" type="password" name="password">
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn btn-default">Login</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </form>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div>
    </body>
</html>